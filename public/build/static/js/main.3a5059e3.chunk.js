(this.webpackJsonppublic=this.webpackJsonppublic||[]).push([[0],{17:function(e,t,a){e.exports=a(40)},40:function(e,t,a){"use strict";a.r(t);var s=a(0),l=a.n(s),r=a(16),n=a.n(r);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=a(1),i=a(2),c=a(3),u=a(4),p=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("div",{className:"col-md-12"},l.a.createElement("h2",{className:"text-center"},l.a.createElement("span",null,"Shrinkflate"),this.props.status?l.a.createElement("small",{style:{fontSize:"medium"}}," ",this.props.status," "):null))}}]),a}(s.Component),m=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("h3",null,this.props.title,": ",this.size)}},{key:"fileSize",value:function(e){var t=Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]}},{key:"size",get:function(){return this.props.size?this.fileSize(this.props.size):"0B"}}]),a}(s.Component),f=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,l=new Array(s),r=0;r<s;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).uploadFile=function(t){if(t.currentTarget.files.length){var a=t.currentTarget.files[0];a.type.match(/^image\//g)?e.props.fileSelected(a):alert("Image files only")}},e}return Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("label",{htmlFor:"upload",className:"btn btn-primary"},l.a.createElement("input",{type:"file",style:{display:"none"},onChange:this.uploadFile,id:"upload"}),"Select image to shrinkflate")}}]),a}(s.Component),h=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,l=new Array(s),r=0;r<s;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).state={size:0,image:null},e.fileSelected=function(t){e.setState({size:t.size});var a=new FileReader;a.onload=function(t){e.setState({image:t.target.result})},a.readAsDataURL(t),e.props.fileSelected(t)},e}return Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-12 d-flex justify-content-between"},l.a.createElement(m,{title:"Original image",size:this.state.size}),l.a.createElement(f,{fileSelected:this.fileSelected})),l.a.createElement("div",{className:"col-md-12"},this.state.image?l.a.createElement("img",{src:this.state.image,className:"img-fluid",alt:""}):null))}}]),a}(s.Component),d=a(6),v=a.n(d),g=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,l=new Array(s),r=0;r<s;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).state={compressor:"libvips",quality:85,progressive:!1,uploading:!1},e.setCompressor=function(t){e.setState({compressor:t.currentTarget.value})},e.setQuality=function(t){e.setState({quality:t.currentTarget.value})},e.setProgressive=function(t){e.setState({progressive:t.currentTarget.checked})},e.startUpload=function(){e.setState({uploading:!0}),e.props.setStatus("uploading");var t=new FormData;t.append("image",e.props.file),t.append("quality",e.state.quality),t.append("progressive",e.state.progressive),t.append("compressor",e.state.compressor);var a=window.location.href.includes("localhost")?"http://localhost:4000":"";v.a.post("".concat(a,"/compress"),t).then((function(t){e.props.uploaded({fileId:t.data,opts:{compressor:e.state.compressor,quality:e.state.quality,progressive:e.state.progressive}})})).catch((function(t){e.setState({uploading:!1}),alert("Error occurred. check console log."),console.log(t)}))},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.setState({compressor:this.props.opts.compressor||"libvips",quality:this.props.opts.quality||85,progressive:this.props.opts.progressive||!1})}},{key:"render",value:function(){return l.a.createElement("div",{className:"col-md-12 ".concat(this.props.className)},l.a.createElement("div",{className:"form-group row"},l.a.createElement("label",{htmlFor:"compressor",className:"col-sm-4 col-form-label"},"Compressor"),l.a.createElement("div",{className:"col-sm-6"},l.a.createElement("select",{value:this.state.compressor,onChange:this.setCompressor,className:"form-control",id:"compressor"},l.a.createElement("option",{value:"libvips"},"libvips(vips)"),l.a.createElement("option",{value:"lilliput"},"lilliput(OpenCV)")))),"lilliput"===this.state.compressor?[l.a.createElement("div",{className:"form-group row",key:"quality"},l.a.createElement("label",{htmlFor:"quality",className:"col-sm-4 col-form-label"},"Quality"),l.a.createElement("div",{className:"col-sm-6"},l.a.createElement("input",{type:"number",min:30,max:100,value:this.state.quality,onChange:this.setQuality,className:"form-control",id:"quality"}))),l.a.createElement("div",{className:"form-group row",key:"progressive"},l.a.createElement("div",{className:"col-sm-6 offset-4 form-check"},l.a.createElement("input",{type:"checkbox",checked:this.state.progressive,onChange:this.setProgressive,id:"progressive",className:"form-check-input"}),l.a.createElement("label",{htmlFor:"progressive",className:"form-check-label"},"Progressive")))]:null,l.a.createElement("button",{className:"btn btn-primary",disabled:this.state.uploading,onClick:this.startUpload},"Compress"))}}]),a}(s.Component),b=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,l=new Array(s),r=0;r<s;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).state={file:null,size:0,url:null,fileId:null,opts:{}},e.reconfigure=function(){e.setState({file:null,fileId:null,url:null,size:0})},e.uploaded=function(t){e.setState({file:e.props.file,fileId:t.fileId,opts:t.opts,url:null}),e.props.setStatus("Uploaded"),e.lookForFinish()},e.lookForFinish=function(){e.props.setStatus("waiting for finish...");var t=window.location.href.includes("localhost")?"http://localhost:4000":"",a="".concat(t,"/download/").concat(e.state.fileId);v.a.get(a+"?q="+(new Date).getTime()).then((function(t){var s=t.headers["content-length"];e.setState({url:a,size:s}),e.props.setStatus("done")})).catch((function(t){t.response&&404===t.response.status?setTimeout(e.lookForFinish,2e3):(alert("Error occurred. check console"),console.log(t),e.props.setStatus("error occurred"))}))},e}return Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("div",{className:"row"},this.state.url&&this.props.file===this.state.file?l.a.createElement("div",{className:"col-md-12 d-flex justify-content-between"},l.a.createElement(m,{title:"Compressed image",size:this.state.size}),l.a.createElement("button",{className:"btn btn-primary",onClick:this.reconfigure},"Reconfigure")):null,this.state.url&&this.props.file===this.state.file?l.a.createElement("div",{className:"col-md-12"},l.a.createElement("img",{src:this.state.url,className:"img-fluid",alt:""})):null,this.props.file!==this.state.file?l.a.createElement(g,{className:"mt-5",uploaded:this.uploaded,setStatus:this.props.setStatus,file:this.props.file,opts:this.state.opts}):null)}}]),a}(s.Component),y=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(o.a)(this,a);for(var s=arguments.length,l=new Array(s),r=0;r<s;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).state={status:null,file:null},e.setFileId=function(t){e.setState({fileId:t})},e.setStatus=function(t){e.setState({status:t})},e.fileSelected=function(t){e.setState({file:t})},e}return Object(i.a)(a,[{key:"render",value:function(){return l.a.createElement("div",{className:"container-fluid"},l.a.createElement("div",{className:"row"},l.a.createElement(p,{status:this.state.status})),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement(h,{setFileId:this.setFileId,fileSelected:this.fileSelected})),l.a.createElement("div",{className:"col-md-6"},l.a.createElement(b,{setStatus:this.setStatus,file:this.state.file}))))}}]),a}(s.Component);a(39);n.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[17,1,2]]]);
//# sourceMappingURL=main.3a5059e3.chunk.js.map